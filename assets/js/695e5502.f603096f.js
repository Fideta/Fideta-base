"use strict";(self.webpackChunkfideta_site=self.webpackChunkfideta_site||[]).push([[5862],{4454:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var o=n(6540),r=n(1656),i=n(4848);function a(){const[e,t]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if(window.innerWidth>768)return void(window.location.href="/");window.history.replaceState(null,"","/scanner");const t=document.createElement("script");return t.src="https://unpkg.com/@ericblade/quagga2@1.2.6/dist/quagga.min.js",t.onload=()=>{(()=>{if(!window.Quagga)return;window.Quagga.init({inputStream:{name:"Live",type:"LiveStream",target:document.querySelector("#scanner"),constraints:{facingMode:"environment",...e?{advanced:[{torch:!0}]}:{}},area:{top:"25%",bottom:"25%",left:"15%",right:"15%"}},decoder:{readers:["ean_reader"],debug:!1},locate:!0,numOfWorkers:0,frequency:5},e=>{e?console.error(e):window.Quagga.start()});let t=null,n=0;window.Quagga.onDetected(e=>{const o=e.codeResult?.code;o&&/^[0-9]{13}$/.test(o)&&(o===t?n+=1:(t=o,n=1),n>=2&&(window.Quagga.stop(),navigator.vibrate&&navigator.vibrate(100),fetch("/ean-index.json").then(e=>e.json()).then(e=>{const r=e[o];r?window.location.replace(r):(alert("Produit non reconnu"),n=0,t=null,window.Quagga.start())}).catch(e=>{alert("Erreur r\xe9seau"),console.error(e),n=0,t=null,window.Quagga.start()})))})})()},document.body.appendChild(t),()=>{window.Quagga?.stop&&window.Quagga.stop();const e=document.querySelector('script[src*="quagga.min.js"]');e&&e.remove()}},[e]);return(0,i.jsxs)(r.A,{title:"Scanner un produit",children:[(0,i.jsx)("a",{href:"/",onClick:e=>{e.preventDefault(),window.location.href="/"},style:{position:"fixed",top:"1rem",left:"1rem",zIndex:3,color:"white",fontWeight:"bold",textDecoration:"none",fontSize:"1.2rem",backgroundColor:"rgba(0,0,0,0.5)",padding:"0.5rem 1rem",borderRadius:"8px"},children:"\u2b05 Retour"}),(0,i.jsx)("div",{id:"scanner",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:0,backgroundColor:"black"}}),(0,i.jsx)("div",{style:{position:"fixed",top:"25%",left:"15%",width:"70%",height:"50%",border:"2px solid #00ff00",borderRadius:"8px",zIndex:2,pointerEvents:"none",boxSizing:"border-box"}}),(0,i.jsx)("button",{onClick:()=>t(e=>!e),style:{position:"fixed",top:"1rem",right:"1rem",zIndex:3,backgroundColor:e?"#ffcc00":"#333",color:"white",border:"none",borderRadius:"8px",padding:"0.5rem 1rem",fontWeight:"bold"},children:e?"\xc9teindre lampe":"Allumer lampe"}),(0,i.jsxs)("div",{style:{position:"fixed",bottom:"2rem",left:"50%",transform:"translateX(-50%)",zIndex:3,backgroundColor:"rgba(0,0,0,0.8)",padding:"1rem",borderRadius:"12px",color:"white",textAlign:"center"},children:[(0,i.jsx)("input",{type:"text",id:"ean-manual-input",placeholder:"Entrez le code EAN",maxLength:13,onFocus:()=>window.Quagga?.pause?.(),onBlur:()=>window.Quagga?.start?.(),style:{padding:"0.5rem",borderRadius:"6px",border:"none",width:"160px",fontSize:"1rem",marginRight:"0.5rem"}}),(0,i.jsx)("button",{onClick:()=>{const e=document.getElementById("ean-manual-input").value;/^[0-9]{13}$/.test(e)?fetch("/ean-index.json").then(e=>e.json()).then(t=>{const n=t[e];n?window.location.replace(n):alert("Produit non reconnu")}).catch(e=>{alert("Erreur r\xe9seau"),console.error(e)}):alert("Code EAN invalide")},style:{backgroundColor:"#00ff00",border:"none",borderRadius:"6px",padding:"0.5rem 1rem",fontWeight:"bold"},children:"OK"})]})]})}}}]);